<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- XML file produced from file: drums.tex
     using Hyperlatex v 2.9-in-waiting-rk (oct06) (c) Otfried Cheong
     on Emacs 22.2.1, Tue Apr 18 10:00:41 2017 -->
<head>
<title>Songlib: drums</title>

<style type="text/css">
.maketitle { align : center }
div.abstract { margin-left: 20%; margin-right: 10%; }
h3.abstract  { align : center }
div.verse, div.quote, div.quotation {
  margin-left : 10%; 
  margin-right : 10%;
}
dt {font-weight: bold}
</style>
<link rel=stylesheet
        href="lusth.css" type="text/css" />
</head>
<body>
<p><h1 class="maketitle">Songlib: drums<br /></h1>
<h2 class="maketitle">written by: Song Li Buser</h2>
<h3 class="maketitle">Revision Date: April 18, 2017</h3>
</p>

<h3><a name="id1"><a href="drums.pdf">Printable Version</a></a></h3><hr />
<h1><a name="id2">Drum support</a></h1><p>
<i><b>Songlib</b></i>&#32;provides three approaches beyond the play/splay/drum set of
functions. They are <i>drumline</i>, whereby you play a set of predefined
patterns, <i>drumkit</i>, whereby you provide separate patterns that are
played by each instrument in the drumkit, and <i>processtab</i>, whereby
you specify a grand pattern describing all instruments that is
subsequently converted into <i><b>songlib</b></i>&#32;code.
The <i>drumline</i> approach is the simplest but least versatile,
while the <i>processtab</i> approach allows more creativity
but requires no programming.
The <i>drumkit</i> approach lies allows creativity, but requires
programming.
</p>

<h1><a name="id3">Drumline</a></h1><p>
The <i>drumline</i> approach utilizes the
<i>drumline</i> function, which plays predefined patterns supplied in
the function call.
The function utilizes a single sample pack which holds single hits on 
various percussive instruments, according to the drumset standard
(see <a href="noteNotations.html">noteNotations.html</a>).
</p>
<p>Here is an example
call to <i>drumline</i>:
</p>
<pre>
    drumset = readScale("/usr/local/samples/share/drumset/","hera_");
    drumline(4,drumset,d44c,0);
</pre>
<p>The first argument to <i>drumline</i> is the number of measures you wish the
drumset instruments to be played.
In the example, the instruments are to be played for 4
measures. The second is the instrument scale do be used.
The third argument is the pattern
to be used. Currently there are nine patterns:
</p>
<ul><li>d44a
</li><li>d44b
</li><li>d44c
</li><li>d44d
</li><li>d44e
</li><li>d44f
</li><li>d44g 
</li><li>d44h 
</li><li>d44i 
</li></ul>
<p>All patterns starting with '44' will each span one measure in
4:4 time. Eventually, there will be d34, and d68 patterns as well.
</p>
<p>The last argument to <i>drumline</i> is
the pattern to play for the last measure, if you
wish to have a different pattern for the last measure. If a zero is
passed the third argument is used for the last measure (<i>i.e</i>.,
all measures
are the same pattern).
</p>
<p>If you wish, you can write your own patterns to send to <i>drumline</i>.
The patterns you send to <i>drumline</i> should look something like:
</p>
<pre>
    void 
    pattern(int drumset)
        {
        ...
        }
</pre>
<p>For example patterns, see:
</p>
<pre>
    ~/songlib/lib/drumlines.c
</pre>
<p>The following pattern demonstrates how to have the pattern change
from one measure to the next:
</p>
<pre>
    void
    d44a(int drumset)
        {
        int totalMeasures = 2;
        static int mode = 0;

        if (drumset &lt; 0)
            {
            mode = 0;
            return;
            }

        switch (mode)
            {
            case 0:
            drum(I,drumset,TOM_MIDDLE);
            drum(Qd,drumset,TOM_MIDDLE);
            drum(H,drumset,TOM_LOW);
            break;
            case 1:
            drum(H,drumset,TOM_LOW);
            drum(I,drumset,TOM_LOW);
            drum(Qd,drumset,TOM_MIDDLE);
            break;
            //add more measures/cases here
            }

        mode = (mode + 1) % totalMeasures;
        }
</pre>
<p>Note that sending a nonsensical drumset (e.g. -1) resets
the pattern back to the beginning. Otherwise, subsequent calls cycle
through the total number of measures
</p>

<h1><a name="id4">Drumkit</a></h1><p>
The <i>drumkit</i> approach utilizes the following set of function:
</p>
<ul><li><i>drumkitCrash</i>
</li><li><i>drumkitHHOpen</i>
</li><li><i>drumkitHHClosed</i>
</li><li><i>drumkitHHPedal</i>
</li><li><i>drumkitRide</i>
</li><li><i>drumkitSnare</i>
</li><li><i>drumkitTom</i>
</li><li><i>drumkitTomHi</i>
</li><li><i>drumkitTomLo</i>
</li><li><i>drumkitKick</i>
</li><li><i>drumkitRim</i>
</li><li><i>drumkitStick</i>
</li><li><i>drumkitCowbell</i>
</li></ul>
<p>An example call to <i>drumkitHHPedal</i> might look like:
</p>
<pre>
    drumkitHHPedal(10,0.75,"-x-x-x-x-x-x-x-x","xxxx",(char *) 0);
</pre>
<p>The first argument is the number of repeats. In this case,
the supplied patterns will be repeated 10 times.
The second argument is the amplitude. In the example, the
amplitude is being set to three-quarters value. The next
arguments are the patterns to be played by the instrument;
patterns are terminated with a zero. Each pattern corresponds
to a measure and the length of the pattern specifies the number
of beats in the measure. For example, the pattern:
</p>
<pre>
    "-x-x-x-x-x-x-x-x"
</pre>
<p>says that the instrument should be played using sixteenth notes.
A <code>'x'</code> in the pattern means the instrument is to be played,
while a <code>'-'</code> in the pattern indicates a rest. The pattern
</p>
<pre>
    "x--x"
</pre>
<p>means the instrument should be played using quarter notes with pattern
"<i>hit</i> <i>rest</i> <i>rest</i> <i>hit</i>". All the other drumkit
functions work in a similar fashion.
</p>
<p>Note, the entire pattern set is played before the set is repeated.
</p>
<p>Here is an example of a 10 measure rock-n-roll beat:
</p>
<pre>
    drumkitStick(1,1,"xxxx",(char *) 0); //intro
    spot = getLocation();
    drumkitCowbell(10,1,"g-g-g-g-g-g-g-g-",(char *) 0); setLocation(spot);
    drumkitKick   (10,1,"x---x---x---x---",(char *) 0); setLocation(spot);
    drumkitSnare  (10,1,"----x-------x---",(char *) 0); setLocation(spot);
    drumkitHHPedal(10,1,"--x---x---x---x-",(char *) 0); setLocation(spot);
    drumkitRim    (10,1,"---x-----x-----x",(char *) 0); setLocation(spot);
    drumkitTomHi  (10,1,"x---x-----x---x-",(char *) 0); setLocation(spot);
    drumkitTom    (10,1,"-------x--------",(char *) 0); setLocation(spot);
    drumkitTomLo  (10,1,"-x------x--x----",(char *) 0); 
</pre>
<p>In a pattern, only certain characters are significant; any other character
is considered a rest. Thus, the following two patterns are
equivalent:
</p>
<pre>
    "x---x-----x---x-"
    "x234x23412x412x4"
</pre>
<p>You may prefer the latter formatting for patterns.
</p>
<p>The default drumkit should have been installed when you installed
<i><b>songlib</b></i>.
If you wish to use different instruments than those in the default drumkit,
you can get and set each instrument individually with the following functions:
</p>
<ul><li><i>getCrash</i>
and <i>setCrash</i>
</li><li><i>getHHOpen</i>
and <i>setHHOpen</i>
</li><li><i>getHHClosed</i>
and <i>setHHClosed</i>
</li><li><i>getHHPedal</i>
and <i>setHHPedal</i>
</li><li><i>getSnare</i>
and <i>setSnare</i>
</li><li><i>getTomHi</i>
and <i>setTomHi</i>
</li><li><i>getTom</i>
and <i>setTom</i>
</li><li><i>getTomLo</i>
and <i>setTomLo</i>
</li><li><i>getKick</i>
and <i>setKick</i>
</li><li><i>getRim</i>
and <i>setRim</i>
</li><li><i>getStick</i>
and <i>setStick</i>
</li><li><i>getCowbell</i>
and <i>setCowbell</i>
</li></ul>
<p>All of these functions behave similarly; here is an example call to
<i>setCrash</i>:
</p>
<pre>
    inst = readScale("/usr/local/share/samples/mydrumkit/","crash_");
    oldCrash = setCrash(inst);
</pre>
<p>Note, the <i>drumkit</i> function assumes that there are exactly 11 samples
in each instrument sample pack, located at notes 0, 12, 24, 36, 48, 60, 72, 84,
96, 108, and 120. Things will go badly if this is not the case for
your custom drumkit.
</p>

<h2><a name="id5">Other drumkit functions</a></h2><p>
For your convenience, there is a generic form of the drumkit functions:
</p>
<pre>
    drumPat(instrument,amplitude,repeats,pattern1,...,patternN,(char *) 0);
</pre>
<p>With <i>drumPat</i>, the instrument is passed in as the first argument.
The <i>roll</i> function can be used to generate a drum roll:
</p>
<pre>
    roll(duration,instrument);
</pre>
<p>The speed of the roll is set with the <i>setRollSpeed</i> function;
the default speed is a <i>32<sup>nd</sup></i> note, meaning
each hit in a roll lasts <i>(1)/(32)</i> of a beat.
A periodic emphasis can be added with the <i>setRollEmphasis</i> function;
the default emphasis is 4, meaning every fourth hit is a little louder
than the others.
</p>
<p>Three more functions in the drumkit family are:
</p>
<pre>
    ghost(duration,instrument);
    flam(duration,instrument,emphasis);
    drag(duration,instrument,emphasis);
</pre>
<p>The <i>ghost</i> function plays a very quiet hit.
The <i>flam</i> function adds a softer grace note before the main hit. 
The <i>emphasis</i> argument dictates how much of an accent is given to
the main hit. A value greater than one makes the main note louder,
while a value less than one makes the main note softer.
The <i>drag</i> function is similar to <i>flam</i>, except two grace notes precede
the main hit.
</p>
<p>As with all other drumkit functions,
the instrument passed to <i>drumPat</i>, <i>roll</i>, and <i>grace</i>,
would have an eleven note sample set with the
notes occurring at multiples of 12.
</p>

<h2><a name="id6">Pattern characters</a></h2><p>
As indicated above, an 'x' in the pattern indicates a hit and a '-' indicates
a rest. Here is a list of all the special characters that can be placed in
a pattern:
</p>
<div align="center">
<p><table><tbody><tr><td colspan="1" align="left">
<code>x</code> </td><td colspan="1" align="left"> a regular hit </td></tr>
<tr><td colspan="1" align="left">
<code>X</code> </td><td colspan="1" align="left"> an emphasized hit </td></tr>
<tr><td colspan="1" align="left">
<code>g</code> </td><td colspan="1" align="left"> a ghost note </td></tr>
<tr><td colspan="1" align="left">
<code>G</code> </td><td colspan="1" align="left"> a ghostier note </td></tr>
<tr><td colspan="1" align="left">
<code>r</code> </td><td colspan="1" align="left"> a roll </td></tr>
<tr><td colspan="1" align="left">
<code>R</code> </td><td colspan="1" align="left"> an emphasized roll </td></tr>
<tr><td colspan="1" align="left">
<code>f</code> </td><td colspan="1" align="left"> a flam (one ghost note) </td></tr>
<tr><td colspan="1" align="left">
<code>F</code> </td><td colspan="1" align="left"> an emphasized flam </td></tr>
<tr><td colspan="1" align="left">
<code>d</code> </td><td colspan="1" align="left"> a drag (two ghost notes) </td></tr>
<tr><td colspan="1" align="left">
<code>D</code> </td><td colspan="1" align="left"> an emphasized drag </td></tr>
<tr><td colspan="1" align="left">
<code>^</code> </td><td colspan="1" align="left"> regular hit, one semitone higher </td></tr>
<tr><td colspan="1" align="left">
<code>A</code> </td><td colspan="1" align="left"> emphasized hit, one semitone higher </td></tr>
<tr><td colspan="1" align="left">
<code>v</code> </td><td colspan="1" align="left"> regular hit, one semitone lower </td></tr>
<tr><td colspan="1" align="left">
<code>V</code> </td><td colspan="1" align="left"> emphasized hit, one semitone lower </td></tr>
<tr><td colspan="1" align="left">
</td></tr></tbody></table>
</p>
</div>
<p>As stated earlier, any character not appearing in the above table is
treated as a rest.
</p>

<h1><a name="id7">Processtab</a></h1><p>
One can generate <i><b>songlib</b></i>&#32;programs using a text description similar to
the patterns used by the <i>drumkit</i> approach. See <a href="tab.html">tab</a>
for more information.
</p>
<address><a href="mailto:lusth@cs.ua.edu"><p>lusth@cs.ua.edu</a></address><br />
</body></html>
